{
  "version": 3,
  "sources": ["../../lib/zhipu-ai.ts"],
  "sourcesContent": ["import assert from \"assert\"\nimport { generateToken } from \"./jwt.js\"\nimport Axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from \"axios\"\nimport Completions, { CreateCompletionsOptions } from \"./completions.js\"\n\nexport type ZhipuAIOptions = {\n    apiKey: string,\n    baseUrl?: string,\n    timeout?: number,\n    maxRetries?: number,\n    customHeaders?: object\n}\n\nexport class ZhipuAI {\n    public __esModule = false\n    public request: AxiosInstance\n\n    constructor(private readonly options: ZhipuAIOptions) {\n        if (!options.apiKey) options.apiKey = process.env['ZHIPUAI_API_KEY'] || ''\n        assert.ok(options.apiKey, \"\u672A\u63D0\u4F9Bapi_key\uFF0C\u8BF7\u901A\u8FC7\u53C2\u6570\u6216\u73AF\u5883\u53D8\u91CF\u63D0\u4F9B\")\n        if (!options.baseUrl) options.baseUrl = process.env[\"ZHIPUAI_BASE_URL\"] || ''\n        if (!options.baseUrl) options.baseUrl = \"https://open.bigmodel.cn/api/paas/v4\"\n        this.request = Axios.create({\n            baseURL: options.baseUrl,\n            timeout: options.timeout,\n            headers: options.customHeaders\n        })\n\n        this.request.interceptors.request.use((config) => {\n            config.headers.set(this.authHeaders())\n            return config;\n        })\n    }\n\n    public async post(url: string, data?: object, config?: AxiosRequestConfig<object>): Promise<AxiosResponse<any>> {\n        return this.request.post(url, data, config)\n    }\n\n    public async createCompletions(options: CreateCompletionsOptions): Promise<AxiosResponse<any>> {\n        return new Completions(this).create(options)\n    }\n\n    authHeaders() {\n        const token = generateToken(this.options.apiKey)\n        return { \"Authorization\": token }\n    }\n}\n\nexport default ZhipuAI"],
  "mappings": ";AAAA,OAAO,YAAY;AACnB,SAAS,qBAAqB;AAC9B,OAAO,WAAiE;AACxE,OAAO,iBAA+C;AAU/C,aAAM,QAAQ;AAAA,EAIjB,YAA6B,SAAyB;AAAzB;AACzB,QAAI,CAAC,QAAQ;AAAQ,cAAQ,SAAS,QAAQ,IAAI,iBAAiB,KAAK;AACxE,WAAO,GAAG,QAAQ,QAAQ,yGAAyB;AACnD,QAAI,CAAC,QAAQ;AAAS,cAAQ,UAAU,QAAQ,IAAI,kBAAkB,KAAK;AAC3E,QAAI,CAAC,QAAQ;AAAS,cAAQ,UAAU;AACxC,SAAK,UAAU,MAAM,OAAO;AAAA,MACxB,SAAS,QAAQ;AAAA,MACjB,SAAS,QAAQ;AAAA,MACjB,SAAS,QAAQ;AAAA,IACrB,CAAC;AAED,SAAK,QAAQ,aAAa,QAAQ,IAAI,CAAC,WAAW;AAC9C,aAAO,QAAQ,IAAI,KAAK,YAAY,CAAC;AACrC,aAAO;AAAA,IACX,CAAC;AAAA,EACL;AAAA,EAlBO,aAAa;AAAA,EACb;AAAA,EAmBP,MAAa,KAAK,KAAa,MAAe,QAAkE;AAC5G,WAAO,KAAK,QAAQ,KAAK,KAAK,MAAM,MAAM;AAAA,EAC9C;AAAA,EAEA,MAAa,kBAAkB,SAAgE;AAC3F,WAAO,IAAI,YAAY,IAAI,EAAE,OAAO,OAAO;AAAA,EAC/C;AAAA,EAEA,cAAc;AACV,UAAM,QAAQ,cAAc,KAAK,QAAQ,MAAM;AAC/C,WAAO,EAAE,iBAAiB,MAAM;AAAA,EACpC;AACJ;AAEA,eAAe;",
  "names": []
}
